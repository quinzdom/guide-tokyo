<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tokyo</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
</head>
<body>

  <!-- Navigation -->
  <nav class="nav">
    <div class="container">
      <a href="index.html" class="nav-logo">Tokyo</a>
      <ul class="nav-links" id="navLinks">
        <li><a href="index.html" class="active">Home</a></li>
        <li><a href="places.html">Places</a></li>
        <li><a href="neighborhoods.html">Neighborhoods</a></li>
      </ul>
      <button class="nav-toggle" id="navToggle" aria-label="Toggle menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </nav>

  <!-- Hero -->
  <header class="hero">
    <div class="container">
      <h1>Tokyo</h1>
    </div>
  </header>

  <!-- Places -->
  <div class="container">
    <div class="section section-home">
      <section class="intro-essay" id="intro">
        <p class="section-label">Introduction</p>
        <pre class="intro-raw" id="introRawText">The true city of Tokyo is generally seen as being the twenty three special wards of Tokyo where 9.7 million people live (2025) while another 2.5 million people commute in every weekday from the extensive suburbs.
This book will primarily focus on these 23 wards because of the outsized importance of this city. I will generally refer to the 23 wards as, simply, Tokyo.
Population
According to the United Nations World Urbanization Prospects 2025 report, the metropolitan area of Tokyo has a population of 33 million, making Tokyo the third largest city in the world behind Jakarta, Indonesia (41 million) and Dhaka, Bangladesh (36 million). After decades as the world’s largest city, Tokyo has not been number one since around 2018.
Comparison with New York City
In some ways we can compare Tokyo’s 23 special wards to the five administrative boroughs of New York City. Tokyo’s 23 wards have an area of 627 square kilometers (242 square miles) while the boroughs of New York City have 778 square kilometers (300 square miles).
This puts New York at 11,000 residents per square kilometer while Tokyo has 15,742 residents per square kilometer.



Tokyo (23 wards)
New York City
Population
9.7 million
8.8 million
Area
627 km2 (242 m2)
778 km2 (300 m2).
Density
15,742 residents / km2
11,000 residents / km2


Where is central Tokyo?
The undeniable economic and cultural center of New York is Manhattan and even within Manhattan, Midtown Manhattan serves as a sort of central core. Tokyo is very different. Tokyo truly has no core, “downtown” area.
For example Shinjuku might be Tokyo’s most iconic area, made iconic through many movies and photographs and when walking around, Shinjuku feels like a city center with its huge scale and activity, but the wealthiest, most prestigious banks and other businesses opt for offices in Marunouchi near the Imperial Palace, the highest end shopping is in Ginza, the youth hang out in Shibuya, and many areas are seen as more desirable places to live and have much higher rents.
Train stations and the core areas of Tokyo.
Tokyo does not have a single center and instead has multiple core areas distributed throughout the wards.
To lay out which areas of Tokyo are the most core areas it is important to know that Tokyo is mostly organized around its train stations. Whenever you ask someone where they live within Tokyo they will usually answer with the name of their nearest train station.
“I live in Shibuya” means that they live near Shibuya station, they are not saying that they live in Shibuya ward, which has many more stations. Similarly, if they talk about the “Shibuya area” this usually means the area around Shibuya station rather than all of Shibuya ward. It is the same thing with Shinjuku station versus Shinjuku ward, and so on.
It is not actually an easy task to define what the core areas of Tokyo are, which is a part of the appeal of Tokyo. You can find massive or interesting areas spread all throughout Tokyo. Nevertheless it can be helpful for understanding Tokyo to have some relatively core areas pointed out.
It is helpful to know about the importance of train stations when learning about the most core areas of Tokyo because we can look at the busiest train stations for a clue as to where they are. The three busiest train stations in Tokyo, which are also the three busiest stations in the world are Shinjuku (3.5 million daily passengers), Shibuya (2.4 million daily passengers) and Ikebukuro (2.1 million daily passengers). (By the way, 45 of the 50 busiest train stations in the world are in Japan, most of which are located in Tokyo, though I think part of this is because of the frequency of transfers between railway companies in Japan.)
Shinjuku and Shibuya are clearly two of the most prominent areas of Tokyo and easily earn “core area” status. Ikebukuro, while an extremely busy area and station, is a definite rank below the other two in terms of importance. A lot of the activity at Ikebukuro station is because of its status as a hub connecting the suburbs in Saitama prefecture with the rest of Tokyo, although it is now also a center for anime and related subcultures and is especially popular with locals when contrasted with the more tourist-dense Akihabara.
After Shinjuku and Shibuya, one more area of Tokyo deserves “core” status and while it is easy to point out the general area it is not quite as simple to point out as the first two areas because this area is not completely centered around one train station.
Put simply, the third and final Tokyo core area is the area east of the Imperial palace, which is also roughly the area around Tokyo station, although many other stations are also within this densely connected area. This area is also referred to as the Marunouchi/Otemachi area. I’m also including Ginza in this area.
First tier core areas
Shinjuku
Shibuya
Tokyo station area

I have also specified a second tier of core areas
Second tier core areas
Ikebukuro
Ueno
Shinagawa

Very quickly, here are the main characteristics of each area.
First tier
Shinjuku
- The biggest transport hub with 12 connected train lines, the most in the world.
- Multiple large department stores, many office buildings, many places to drink and eat at night, including in Golden Gai, and Kabukicho, which is a red light district but bizarrely is now also a major entertainment district in its own right, separate from the red light activities.
Shibuya
- Extremely popular with young people, middle school to college age, as well as with foreigners. The area around the station has numerous massive and modern buildings filled with places to shop and eat and hang out. Shibuya also has the highest concentration of night clubs in Tokyo, aimed on average towards younger people.
- Walking distance to the fashionable shopping districts of Harajuku and Omotesando.
Tokyo Station area (Marunouchi/Otemachi)
- Near the geographical center of Tokyo, next to the Imperial Palace.
- Transport hub and a major stop for the Shinkansen bullet train.
- Contains the business district of Marunouchi and is bordered by the high end shopping district of Ginza.
Second tier
Ikebukuro
- Major transport hub.
- Big shopping center including the shopping complex Sunshine City. Major shopping area for anime and other related subcultures.
- Many Chinese residents of Tokyo live here and it’s a great area for Chinese food.
Ueno
- Has a great and big park, Ueno park, and the Ueno zoo.
- Multiple major museums including Tokyo National Museum, National Museum of Western Art and the Tokyo Metropolitan Art Museum.
- Major area for drinking and shopping, including street vendors along Ameyoko street.
Shinagawa
- Major transport hub in the southern part of Tokyo, connected to the suburbs and to Haneda airport, and a stop for the Shinkansen.
- Large shopping and hotel area.

Because of the size and particular composition of Tokyo, becoming familiar with these five core areas does not actually get you very far into understanding Tokyo. This book will improve your understanding of Tokyo systematically, in stages, with the information presented in order of importance and explanatory power.
Now that I have briefly covered the five areas of Shinjuku, Shibuya, Marunouchi, Ikebukuro, Ueno, I will introduce the most important train line in Tokyo, the JR (East Japan Railway) Yamanote Line. This information is even more important than the previous section for someone who needs to navigate Tokyo for the first time. As a visitor to Tokyo, you can think of the Yamanote line as your most important tool for navigating the city.

You can see that all six of the major areas are connected by the Yamanote line, which runs in the loop. In addition, most of the other stations on the line are also prominent areas. Property and rent prices are at a premium near almost any station on the Yamanote line.
If you only use the Yamanote line during your time in Tokyo you will have more than enough to do for many months, although it is of course not efficient to take the line when the stations you are going between are on opposite sides of the city, since it is a loop. For example, going from Shinjuku station to Tokyo station on the Yamanote line takes around 36 minutes while the JR Chuo line takes just 14 minutes. By the way, the JR Chuo line takes a bizarre route because it goes around the massive Imperial Palace area, as does every other train and metro.
Here are some of the particularly interesting neighborhoods on the Yamanote line
Takadanobaba
Shin-Okubo
Yoyogi
Harajuku
Ebisu
Meguro
Gotanda
Takanawa Gateway
Shimbashi
Yurakucho
Kanda
Akihabara
Nishi-Nippori
Sugamo</pre>
        <div class="intro-formatted" id="introFormattedText"></div>
      </section>

      <div class="places-heading">
        <p class="section-label">Places</p>
        <h2>Some Places I Like in Tokyo</h2>
      </div>

      <!-- Filters -->
      <div class="filter-bar">
        <div class="filter-group">
          <span class="filter-group-label">Category</span>
          <button class="filter-btn active" data-filter="category" data-value="all">All</button>
          <button class="filter-btn" data-filter="category" data-value="cafe">Cafe</button>
          <button class="filter-btn" data-filter="category" data-value="ramen">Ramen</button>
          <button class="filter-btn" data-filter="category" data-value="sushi">Sushi</button>
          <button class="filter-btn" data-filter="category" data-value="tonkatsu">Tonkatsu</button>
          <button class="filter-btn" data-filter="category" data-value="izakaya">Izakaya</button>
          <button class="filter-btn" data-filter="category" data-value="italian">Italian</button>
          <button class="filter-btn" data-filter="category" data-value="foreign">Foreign</button>
        </div>
        <div class="filter-divider"></div>
        <div class="filter-group">
          <span class="filter-group-label">Area</span>
          <button class="filter-btn active" data-filter="neighborhood" data-value="all">All</button>
          <button class="filter-btn" data-filter="neighborhood" data-value="koenji">Koenji</button>
          <button class="filter-btn" data-filter="neighborhood" data-value="okubo">Okubo</button>
          <button class="filter-btn" data-filter="neighborhood" data-value="meguro">Meguro</button>
          <button class="filter-btn" data-filter="neighborhood" data-value="shinjuku">Shinjuku</button>
          <button class="filter-btn" data-filter="neighborhood" data-value="ebisu">Ebisu</button>
        </div>
      </div>

      <!-- Card Grid -->
      <div class="card-grid" id="placeGrid">

        <!-- Ramen Yama-to-ki -->
        <article class="card" data-category="ramen" data-neighborhood="koenji">
          <div class="card-meta">
            <span class="tag">Ramen</span>
            <span class="tag tag--neighborhood">Koenji</span>
          </div>
          <div class="card-header">
            <h3><a href="ramen-yama-to-ki.html">Ramen Yama-to-ki</a></h3>
          </div>
          <p class="card-description">My favorite ramen. I recommend the shoyu ramen. The ramen is light. It has been consistently good. The location is a little bit out of the way and there is usually a line so showing up well before closing time is recommended.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;1,200</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star filled">●</span>
              <span class="rating-star filled">●</span>
            </div>
          </div>
        </article>

        <!-- Tonkatsu Taiho -->
        <article class="card" data-category="tonkatsu" data-neighborhood="meguro">
          <div class="card-meta">
            <span class="tag">Tonkatsu</span>
            <span class="tag tag--neighborhood">Meguro</span>
          </div>
          <div class="card-header">
            <h3><a href="tonkatsu-taiho.html">Tonkatsu Taiho</a></h3>
          </div>
          <p class="card-description">Extremely good tonkatsu that is absurdly good for the price. I recommend the hire-katsu, then the tonkatsu. I don't recommend it exactly but the takeout is also great here. Also, it's better when the lady is cooking.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;1,800</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

        <!-- Shunou Hantai -->
        <article class="card" data-category="izakaya" data-neighborhood="meguro">
          <div class="card-meta">
            <span class="tag">Izakaya</span>
            <span class="tag tag--neighborhood">Meguro</span>
          </div>
          <div class="card-header">
            <h3><a href="shunou-hantai.html">Shunou Hantai</a></h3>
          </div>
          <p class="card-description">Tasteful and tastefully prepared unique dishes. The chef is a bit odd and the menu is hand-written so it may be difficult to order without knowing Japanese.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;5,000</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

        <!-- Kaori-za -->
        <article class="card" data-category="cafe" data-neighborhood="okubo">
          <div class="card-meta">
            <span class="tag">Cafe</span>
            <span class="tag tag--neighborhood">Okubo</span>
          </div>
          <div class="card-header">
            <h3><a href="kaori-za.html">Kaori-za</a></h3>
          </div>
          <p class="card-description">A cafe that happens to be the charmingly bizarre basement living room of the owner.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;1,200</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

        <!-- Yurakucho Kakida -->
        <article class="card" data-category="sushi" data-neighborhood="shinjuku">
          <div class="card-meta">
            <span class="tag">Sushi</span>
            <span class="tag tag--neighborhood">Shinjuku</span>
          </div>
          <div class="card-header">
            <h3><a href="yurakucho-kakida.html">Yurakucho Kakida</a></h3>
          </div>
          <p class="card-description">All-you-can-eat sushi with high quality raw ingredients at a reasonable price.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;15,000</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

        <!-- Thai Isaan -->
        <article class="card" data-category="foreign" data-neighborhood="ebisu">
          <div class="card-meta">
            <span class="tag">Foreign</span>
            <span class="tag tag--neighborhood">Ebisu</span>
          </div>
          <div class="card-header">
            <h3><a href="thai-isaan.html">Thai Isaan</a></h3>
          </div>
          <p class="card-description">Nice, fairly casual Thai place. I recommend the pad see ew.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;1,500</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

        <!-- Efelif Kebab -->
        <article class="card" data-category="foreign" data-neighborhood="okubo">
          <div class="card-meta">
            <span class="tag">Foreign</span>
            <span class="tag tag--neighborhood">Okubo</span>
          </div>
          <div class="card-header">
            <h3><a href="efelif-kebab.html">Efelif Kebab</a></h3>
          </div>
          <p class="card-description">A food cart with generous portions and a sociable chef.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;1,000</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

        <!-- Del Sol -->
        <article class="card" data-category="italian" data-neighborhood="koenji">
          <div class="card-meta">
            <span class="tag">Italian</span>
            <span class="tag tag--neighborhood">Koenji</span>
          </div>
          <div class="card-header">
            <h3><a href="del-sol.html">Del Sol</a></h3>
          </div>
          <p class="card-description">Solid Italian food at a reasonable price.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;1,200</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

        <!-- Vietnam Chan -->
        <article class="card" data-category="foreign" data-neighborhood="okubo">
          <div class="card-meta">
            <span class="tag">Foreign</span>
            <span class="tag tag--neighborhood">Okubo</span>
          </div>
          <div class="card-header">
            <h3><a href="vietnam-chan.html">Vietnam Chan</a></h3>
          </div>
          <p class="card-description">Very good Vietnamese food. I especially recommend the lunchtime pho.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;1,500</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

        <!-- R-za Dokushokan -->
        <article class="card" data-category="cafe" data-neighborhood="koenji">
          <div class="card-meta">
            <span class="tag">Cafe</span>
            <span class="tag tag--neighborhood">Koenji</span>
          </div>
          <div class="card-header">
            <h3><a href="r-za-dokushokan.html">R-za Dokushokan</a></h3>
          </div>
          <p class="card-description">Interesting cafe environment filled with plants and books. Great for quietly reading.</p>
          <div class="card-footer">
            <span class="card-price">avg. <strong>&yen;700</strong></span>
            <div class="rating">
              <span class="rating-star filled">●</span>
              <span class="rating-star">○</span>
              <span class="rating-star">○</span>
            </div>
          </div>
        </article>

      </div>

      <p id="noResults" style="display:none; text-align:center; color:var(--color-text-muted); padding: var(--space-lg) 0;">
        No places match the selected filters.
      </p>

    </div>
  </div>

  <!-- Map -->
  <section class="map-section">
    <div class="map-section-header container">
      <p class="section-label">On the map</p>
      <h2>Where to find them</h2>
    </div>
    <div id="tokyo-map"></div>
  </section>

  <script>
    (function () {
      const intro = document.getElementById('intro');
      const rawEl = document.getElementById('introRawText');
      const target = document.getElementById('introFormattedText');
      if (!intro || !rawEl || !target) return;

      const lines = rawEl.textContent.replace(/\r/g, '').split('\n').map((line) => line.trim());
      const findExact = (value, fromIndex = 0) => lines.findIndex((line, index) => index >= fromIndex && line === value);
      const findPrefix = (value, fromIndex = 0) => lines.findIndex((line, index) => index >= fromIndex && line.startsWith(value));
      const nonEmpty = (start, end) => lines.slice(start, end).filter(Boolean);

      const idxPopulation = findExact('Population');
      const idxComparison = findExact('Comparison with New York City', idxPopulation + 1);
      const idxTableStart = findExact('Tokyo (23 wards)', idxComparison + 1);
      const idxWhere = findExact('Where is central Tokyo?', idxTableStart + 1);
      const idxFirstTierCore = findExact('First tier core areas', idxWhere + 1);
      const idxSecondTierCore = findExact('Second tier core areas', idxFirstTierCore + 1);
      const idxVeryQuickly = findExact('Very quickly, here are the main characteristics of each area.', idxSecondTierCore + 1);
      const idxBecause = findPrefix('Because of the size and particular composition of Tokyo', idxVeryQuickly + 1);
      const idxNow = findPrefix('Now that I have briefly covered', idxBecause + 1);
      const idxRestaurant = findExact('Restaurant', idxNow + 1);
      const idxNeighborhoods = findExact('Here are some of the particularly interesting neighborhoods on the Yamanote line', idxRestaurant + 1);

      const required = [
        idxPopulation,
        idxComparison,
        idxTableStart,
        idxWhere,
        idxFirstTierCore,
        idxSecondTierCore,
        idxVeryQuickly,
        idxBecause,
        idxNow,
        idxNeighborhoods
      ];
      if (required.some((index) => index < 0)) return;

      const create = (tag, className, text) => {
        const element = document.createElement(tag);
        if (className) element.className = className;
        if (typeof text === 'string') element.textContent = text;
        return element;
      };

      const createPanel = (title, extraClass) => {
        const panel = create('section', `intro-panel ${extraClass || ''}`.trim());
        if (title) panel.appendChild(create('h3', 'intro-panel-title', title));
        target.appendChild(panel);
        return panel;
      };

      const appendParagraphs = (container, textLines) => {
        textLines.forEach((text) => container.appendChild(create('p', '', text)));
      };

      const leadPanel = createPanel('', 'intro-panel-lead');
      appendParagraphs(leadPanel, nonEmpty(0, idxPopulation));

      const populationPanel = createPanel(lines[idxPopulation], '');
      appendParagraphs(populationPanel, nonEmpty(idxPopulation + 1, idxComparison));

      const comparisonPanel = createPanel(lines[idxComparison], '');
      appendParagraphs(comparisonPanel, nonEmpty(idxComparison + 1, idxTableStart));

      const tableData = nonEmpty(idxTableStart, idxWhere);
      if (tableData.length >= 11) {
        const tableWrap = create('div', 'intro-compare-table-wrap', '');
        const table = create('table', 'intro-compare-table', '');
        const thead = create('thead', '', '');
        const headerRow = create('tr', '', '');
        headerRow.appendChild(create('th', '', ''));
        headerRow.appendChild(create('th', '', tableData[0]));
        headerRow.appendChild(create('th', '', tableData[1]));
        thead.appendChild(headerRow);
        table.appendChild(thead);

        const tbody = create('tbody', '', '');
        for (let index = 2; index < tableData.length; index += 3) {
          const row = create('tr', '', '');
          row.appendChild(create('td', '', tableData[index] || ''));
          row.appendChild(create('td', '', tableData[index + 1] || ''));
          row.appendChild(create('td', '', tableData[index + 2] || ''));
          tbody.appendChild(row);
        }
        table.appendChild(tbody);
        tableWrap.appendChild(table);
        comparisonPanel.appendChild(tableWrap);
      }

      const centralPanel = createPanel(lines[idxWhere], '');
      nonEmpty(idxWhere + 1, idxFirstTierCore).forEach((line) => {
        if (line === 'Train stations and the core areas of Tokyo.') {
          centralPanel.appendChild(create('h4', 'intro-subtitle', line));
        } else {
          centralPanel.appendChild(create('p', '', line));
        }
      });

      const corePanel = createPanel('', '');
      const firstTierLines = nonEmpty(idxFirstTierCore + 1, idxSecondTierCore);
      const secondTierLines = nonEmpty(idxSecondTierCore + 1, idxVeryQuickly);
      const noteLine = 'I have also specified a second tier of core areas';
      const firstTierAreas = firstTierLines.filter((line) => line !== noteLine);
      const coreGrid = create('div', 'intro-tier-grid', '');

      const firstCard = create('div', 'intro-tier-card', '');
      firstCard.appendChild(create('h4', '', lines[idxFirstTierCore]));
      const firstList = create('ul', 'intro-tier-list', '');
      firstTierAreas.forEach((line) => {
        firstList.appendChild(create('li', '', line));
      });
      firstCard.appendChild(firstList);
      coreGrid.appendChild(firstCard);

      const secondCard = create('div', 'intro-tier-card', '');
      secondCard.appendChild(create('h4', '', lines[idxSecondTierCore]));
      const secondList = create('ul', 'intro-tier-list', '');
      secondTierLines.forEach((line) => {
        secondList.appendChild(create('li', '', line));
      });
      secondCard.appendChild(secondList);
      coreGrid.appendChild(secondCard);

      corePanel.appendChild(coreGrid);
      if (firstTierLines.includes(noteLine)) corePanel.appendChild(create('p', '', noteLine));

      const characteristicsPanel = createPanel(lines[idxVeryQuickly], '');
      const characteristicLines = nonEmpty(idxVeryQuickly + 1, idxBecause);
      const tierOrder = ['First tier', 'Second tier'];
      const areasByTier = { 'First tier': [], 'Second tier': [] };
      let currentTier = '';
      let currentArea = null;

      characteristicLines.forEach((line) => {
        if (tierOrder.includes(line)) {
          currentTier = line;
          currentArea = null;
          return;
        }
        if (line.startsWith('- ')) {
          if (currentArea) currentArea.bullets.push(line);
          return;
        }
        if (!currentTier) return;
        currentArea = { name: line, bullets: [] };
        areasByTier[currentTier].push(currentArea);
      });

      const characteristicGrid = create('div', 'intro-character-grid', '');
      tierOrder.forEach((tierName) => {
        if (!areasByTier[tierName].length) return;
        const tierCard = create('div', 'intro-character-tier', '');
        tierCard.appendChild(create('h4', '', tierName));
        areasByTier[tierName].forEach((area) => {
          const areaCard = create('article', 'intro-area-card', '');
          areaCard.appendChild(create('p', 'intro-area-name', area.name));
          const bulletList = create('ul', 'intro-bullet-list', '');
          area.bullets.forEach((bullet) => {
            bulletList.appendChild(create('li', '', bullet));
          });
          areaCard.appendChild(bulletList);
          tierCard.appendChild(areaCard);
        });
        characteristicGrid.appendChild(tierCard);
      });
      characteristicsPanel.appendChild(characteristicGrid);

      const transitionPanel = createPanel('', '');
      appendParagraphs(transitionPanel, nonEmpty(idxBecause, idxNow + 1));

      const yamanoteTitle = idxRestaurant >= 0 ? lines[idxRestaurant] : 'Yamanote Line';
      const yamanoteStart = idxRestaurant >= 0 ? idxRestaurant + 1 : idxNow + 1;
      const yamanotePanel = createPanel(yamanoteTitle, '');
      appendParagraphs(yamanotePanel, nonEmpty(yamanoteStart, idxNeighborhoods));
      yamanotePanel.appendChild(create('h4', 'intro-subtitle', lines[idxNeighborhoods]));

      const stationList = create('div', 'station-list', '');
      nonEmpty(idxNeighborhoods + 1, lines.length).forEach((station) => {
        stationList.appendChild(create('span', 'station-chip', station));
      });
      yamanotePanel.appendChild(stationList);

      intro.classList.add('is-enhanced');
    })();
  </script>

  <script>
    document.getElementById('navToggle').addEventListener('click', function() {
      document.getElementById('navLinks').classList.toggle('open');
    });

    const state = { category: 'all', neighborhood: 'all' };
    const cards = document.querySelectorAll('.card');
    const noResults = document.getElementById('noResults');

    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const filterType = this.dataset.filter;
        this.closest('.filter-group')
            .querySelectorAll('.filter-btn')
            .forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        state[filterType] = this.dataset.value;
        applyFilters();
      });
    });

    function applyFilters() {
      let visible = 0;
      cards.forEach(card => {
        const catMatch = state.category === 'all' || card.dataset.category === state.category;
        const hoodMatch = state.neighborhood === 'all' || card.dataset.neighborhood === state.neighborhood;
        const show = catMatch && hoodMatch;
        card.style.display = show ? '' : 'none';
        if (show) visible++;
      });
      noResults.style.display = visible === 0 ? '' : 'none';
    }
  </script>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const map = L.map('tokyo-map', {
      center: [35.668, 139.700],
      zoom: 12,
      scrollWheelZoom: false,
      zoomControl: true
    });

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(map);

    const markerIcon = L.divIcon({
      className: 'map-marker',
      html: '<div class="marker-pin"></div>',
      iconSize: [16, 16],
      iconAnchor: [8, 8],
      popupAnchor: [0, -12]
    });

    const places = [
      { name: 'Kaori-za',          url: 'kaori-za.html',          lat: 35.6998, lng: 139.6990, cat: 'Cafe',     hood: 'Okubo' },
      { name: 'Yurakucho Kakida',  url: 'yurakucho-kakida.html',  lat: 35.6895, lng: 139.7010, cat: 'Sushi',    hood: 'Shinjuku' },
      { name: 'Thai Isaan',        url: 'thai-isaan.html',        lat: 35.6479, lng: 139.7100, cat: 'Foreign',  hood: 'Ebisu' },
      { name: 'Efelif Kebab',      url: 'efelif-kebab.html',      lat: 35.7015, lng: 139.7008, cat: 'Foreign',  hood: 'Okubo' },
      { name: 'Tonkatsu Taiho',    url: 'tonkatsu-taiho.html',    lat: 35.6318, lng: 139.7145, cat: 'Tonkatsu', hood: 'Meguro' },
      { name: 'Shunou Hantai',     url: 'shunou-hantai.html',     lat: 35.6335, lng: 139.7170, cat: 'Izakaya',  hood: 'Meguro' },
      { name: 'Del Sol',           url: 'del-sol.html',           lat: 35.7055, lng: 139.6490, cat: 'Italian',  hood: 'Koenji' },
      { name: 'Vietnam Chan',      url: 'vietnam-chan.html',       lat: 35.7005, lng: 139.7016, cat: 'Foreign',  hood: 'Okubo' },
      { name: 'Ramen Yama-to-ki',  url: 'ramen-yama-to-ki.html',  lat: 35.7080, lng: 139.6480, cat: 'Ramen',   hood: 'Koenji' },
      { name: 'R-za Dokushokan',   url: 'r-za-dokushokan.html',   lat: 35.7040, lng: 139.6505, cat: 'Cafe',    hood: 'Koenji' },
    ];

    places.forEach(p => {
      const popup = L.popup({ closeButton: false, className: 'map-popup-wrapper' }).setContent(
        `<div class="map-popup">
          <a href="${p.url}" class="map-popup-name">${p.name}</a>
          <span class="map-popup-meta">${p.cat} &middot; ${p.hood}</span>
        </div>`
      );
      L.marker([p.lat, p.lng], { icon: markerIcon }).addTo(map).bindPopup(popup);
    });
  </script>

</body>
</html>
